<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canberra Maths Adventure</title>
    <style>
        /* ACT School / Kid-Friendly Vibe */
        body {
            font-family: 'Comic Sans MS', 'Arial', sans-serif;
            background-color: #e0f7fa;
            text-align: center;
            padding: 20px;
            margin: 0;
            touch-action: manipulation; /* Prevents double-tap zoom on mobile */
        }

        h1 {
            color: #006064;
            margin-top: 0;
        }

        .tagline {
            margin-top: 0;
            color: #004d40;
            font-size: 16px;
        }

        .game-container {
            max-width: 700px;
            margin: 0 auto 30px auto;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
        }

        .game-screen {
            display: none;
        }

        /* Menu cards */
        .game-card-grid {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
        }

        @media (min-width: 650px) {
            .game-card-grid {
                flex-direction: row;
            }
        }

        .game-card {
            flex: 1;
            background: #f1f8e9;
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        .game-card h2 {
            margin-top: 0;
            font-size: 20px;
            color: #33691e;
        }

        .game-card p {
            font-size: 14px;
            min-height: 48px;
        }

        .btn-primary, .btn-mode, .btn-answer, .btn-small, .btn-submit, .btn-back {
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
        }

        .btn-primary {
            background-color: #0097a7;
            color: white;
            padding: 10px 16px;
            font-size: 16px;
            width: 100%;
            max-width: 180px;
        }

        .btn-primary:hover {
            background-color: #006064;
        }

        .btn-mode {
            background-color: #0097a7;
            color: white;
            padding: 8px 10px;
            margin: 3px;
            font-size: 14px;
        }

        .btn-mode.active {
            background-color: #004d40;
        }

        .btn-answer {
            background-color: #ffb74d;
            padding: 10px;
            font-size: 20px;
            margin: 5px;
            min-width: 70px;
        }

        .btn-answer:hover {
            background-color: #f57c00;
        }

        .btn-small {
            background-color: #eeeeee;
            padding: 6px 10px;
            font-size: 14px;
            margin: 3px;
        }

        .btn-small.active {
            background-color: #c5e1a5;
        }

        .btn-submit {
            background-color: #ff9800;
            color: white;
            padding: 10px 20px;
            font-size: 20px;
            margin-left: 8px;
        }

        .btn-submit:hover {
            background-color: #f57c00;
        }

        .btn-back {
            margin-top: 12px;
            background: none;
            color: grey;
            text-decoration: underline;
            padding: 6px 10px;
            font-size: 14px;
        }

        .scene {
            background-color: #8bc34a; /* Grass */
            height: 150px;
            border-radius: 10px;
            position: relative;
            overflow: hidden;
            margin: 15px 0 20px 0;
            border-bottom: 10px solid #558b2f;
        }

        .wombat {
            font-size: 60px;
            position: absolute;
            bottom: 10px;
            left: 5%;
            transition: left 0.4s ease;
        }

        .target {
            font-size: 60px;
            position: absolute;
            bottom: 10px;
            right: 5%;
        }

        .question-box {
            font-size: 34px;
            font-weight: bold;
            color: #333;
            margin: 10px 0;
        }

        .sub-question {
            font-size: 20px;
            margin: 8px 0 12px 0;
            color: #555;
        }

        input[type="number"] {
            font-size: 26px;
            padding: 8px;
            width: 90px;
            text-align: center;
            border-radius: 8px;
            border: 2px solid #ccc;
        }

        .message {
            min-height: 26px;
            font-size: 18px;
            margin-top: 8px;
            font-weight: bold;
        }

        .correct { color: #2e7d32; }
        .wrong { color: #d32f2f; }

        .score-row {
            display: flex;
            justify-content: center;
            gap: 20px;
            font-size: 16px;
            margin: 5px 0 10px 0;
        }

        .score-row span strong {
            color: #004d40;
        }

        .answer-options {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .pill-row {
            margin: 10px 0 15px 0;
        }

        .small-info {
            font-size: 14px;
            color: #555;
            margin-top: 6px;
        }

        /* Reward visual */
        .confetti {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
            display: none;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 10"><circle cx="5" cy="5" r="2" fill="gold"/></svg>');
            background-size: 20px 20px;
            animation: fall 2s linear infinite;
            z-index: 999;
        }

        @keyframes fall {
            from { background-position: 0 0; }
            to   { background-position: 0 100vh; }
        }

        footer {
            font-size: 12px;
            color: #555;
            margin-top: 10px;
        }
    </style>
</head>
<body>

    <div class="confetti" id="confetti"></div>

    <!-- MAIN MENU -->
    <div class="game-container" id="main-menu">
        <h1>Canberra Maths Adventure</h1>
        <p class="tagline">
            No ads, no stress ‚Äì just wombats, roos and numbers.
        </p>

        <div class="game-card-grid">
            <div class="game-card">
                <h2>üê® Wombat Walk (+ ‚àí √ó)</h2>
                <p>Help Wally the Wombat walk all the way to Black Mountain by solving questions.</p>
                <button class="btn-primary" onclick="openGame('wombat')">Play</button>
            </div>

            <div class="game-card">
                <h2>ü¶ò Times Table Jump</h2>
                <p>Quick-fire practice with the key Year 3 tables: 2, 3, 5 and 10.</p>
                <button class="btn-primary" onclick="openGame('times')">Play</button>
            </div>

            <div class="game-card">
                <h2>ü¶ú Place Value Patrol</h2>
                <p>Hundreds, tens and ones. Crack the secret digit and earn stars.</p>
                <button class="btn-primary" onclick="openGame('place')">Play</button>
            </div>
        </div>
    </div>

    <!-- GAME 1: Wombat Walk -->
    <div class="game-container game-screen" id="wombat-screen">
        <h1>üê® Wombat Walk Math</h1>
        <p>Choose a mode and help Wally reach Black Mountain.</p>

        <div class="pill-row">
            <button class="btn-mode active" id="wombat-mode-add" onclick="wombatSetMode('add')">Addition (+)</button>
            <button class="btn-mode" id="wombat-mode-sub" onclick="wombatSetMode('sub')">Subtraction (‚àí)</button>
            <button class="btn-mode" id="wombat-mode-mul" onclick="wombatSetMode('mul')">Multiplication (√ó)</button>
        </div>

        <div class="scene">
            <div class="wombat" id="wombat-wombat">üê®</div>
            <div class="target">üå≤</div>
        </div>

        <div class="question-box" id="wombat-question">2 + 2 = ?</div>

        <div>
            <input type="number" id="wombat-answer" placeholder="?" inputmode="numeric">
            <button class="btn-submit" onclick="wombatCheckAnswer()">Go!</button>
        </div>

        <div class="score-row">
            <span>Steps: <strong><span id="wombat-score">0</span> / <span id="wombat-target-score">10</span></strong></span>
        </div>

        <div class="message" id="wombat-message"></div>

        <button class="btn-back" onclick="goHome()">‚¨Ö Back to Games</button>
    </div>

    <!-- GAME 2: Times Table Jump -->
    <div class="game-container game-screen" id="times-screen">
        <h1>ü¶ò Times Table Jump</h1>
        <p>Tap the correct answer to help Joey jump along!</p>

        <div class="pill-row">
            <button class="btn-small active" id="times-table-mix" onclick="setTimesTable('mix')">Mix 2,3,5,10</button>
            <button class="btn-small" id="times-table-2" onclick="setTimesTable(2)">√ó2</button>
            <button class="btn-small" id="times-table-3" onclick="setTimesTable(3)">√ó3</button>
            <button class="btn-small" id="times-table-5" onclick="setTimesTable(5)">√ó5</button>
            <button class="btn-small" id="times-table-10" onclick="setTimesTable(10)">√ó10</button>
        </div>

        <div class="score-row">
            <span>Score: <strong><span id="times-score">0</span></strong></span>
            <span>Streak: <strong><span id="times-streak">0</span></strong></span>
        </div>

        <div class="question-box" id="times-question">2 √ó 3 = ?</div>

        <div class="answer-options">
            <button class="btn-answer" id="times-opt-0" onclick="timesCheckAnswer(this)"></button>
            <button class="btn-answer" id="times-opt-1" onclick="timesCheckAnswer(this)"></button>
            <button class="btn-answer" id="times-opt-2" onclick="timesCheckAnswer(this)"></button>
        </div>

        <div class="message" id="times-message"></div>

        <button class="btn-back" onclick="goHome()">‚¨Ö Back to Games</button>
    </div>

    <!-- GAME 3: Place Value Patrol -->
    <div class="game-container game-screen" id="place-screen">
        <h1>ü¶ú Place Value Patrol</h1>
        <p>Read the number, then pick the correct digit.</p>

        <div class="score-row">
            <span>Score: <strong><span id="place-score">0</span></strong></span>
        </div>

        <div class="question-box" id="place-number">384</div>
        <div class="sub-question" id="place-question">What is the tens digit?</div>

        <div class="answer-options">
            <button class="btn-answer" id="place-opt-0" onclick="placeCheckAnswer(this)"></button>
            <button class="btn-answer" id="place-opt-1" onclick="placeCheckAnswer(this)"></button>
            <button class="btn-answer" id="place-opt-2" onclick="placeCheckAnswer(this)"></button>
        </div>

        <div class="message" id="place-message"></div>

        <button class="btn-back" onclick="goHome()">‚¨Ö Back to Games</button>
    </div>

    <footer>
        Built with ‚ù§Ô∏è in Canberra. (Also: totally allowed for parent hints.)
    </footer>

    <script>
        /* ---------- SHARED NAV + CONFETTI ---------- */
        const confetti = document.getElementById('confetti');

        function fireConfetti(durationMs = 2000) {
            confetti.style.display = 'block';
            setTimeout(() => {
                confetti.style.display = 'none';
            }, durationMs);
        }

        function hideAllGameScreens() {
            const screens = document.querySelectorAll('.game-screen');
            screens.forEach(s => s.style.display = 'none');
        }

        function openGame(gameName) {
            document.getElementById('main-menu').style.display = 'none';
            hideAllGameScreens();

            if (gameName === 'wombat') {
                document.getElementById('wombat-screen').style.display = 'block';
                initWombat();
            } else if (gameName === 'times') {
                document.getElementById('times-screen').style.display = 'block';
                startTimesGame();
            } else if (gameName === 'place') {
                document.getElementById('place-screen').style.display = 'block';
                startPlaceGame();
            }
        }

        function goHome() {
            hideAllGameScreens();
            document.getElementById('main-menu').style.display = 'block';
        }

        /* ---------- GAME 1: Wombat Walk ---------- */
        let wombatCurrentMode = 'add';
        let wombatNum1, wombatNum2, wombatCorrectAnswer;
        let wombatScore = 0;
        const wombatWinningScore = 10;

        const wombatEl = document.getElementById('wombat-wombat');
        const wombatQuestionEl = document.getElementById('wombat-question');
        const wombatAnswerInput = document.getElementById('wombat-answer');
        const wombatMessageEl = document.getElementById('wombat-message');
        const wombatScoreEl = document.getElementById('wombat-score');
        const wombatTargetScoreEl = document.getElementById('wombat-target-score');

        const wombatModeButtons = {
            add: document.getElementById('wombat-mode-add'),
            sub: document.getElementById('wombat-mode-sub'),
            mul: document.getElementById('wombat-mode-mul')
        };

        wombatTargetScoreEl.innerText = wombatWinningScore;

        if (wombatAnswerInput) {
            wombatAnswerInput.addEventListener('keypress', function (event) {
                if (event.key === 'Enter') {
                    wombatCheckAnswer();
                }
            });
        }

        function initWombat() {
            wombatSetMode('add'); // sets score + question
            wombatMessageEl.innerText = '';
        }

        function wombatSetMode(mode) {
            wombatCurrentMode = mode;
            wombatScore = 0;
            wombatScoreEl.innerText = wombatScore;
            wombatUpdatePosition();
            // Highlight active mode
            Object.keys(wombatModeButtons).forEach(m => {
                wombatModeButtons[m].classList.toggle('active', m === mode);
            });
            wombatGenerateQuestion();
        }

        function wombatGenerateQuestion() {
            wombatMessageEl.innerText = '';
            wombatMessageEl.className = 'message';
            wombatAnswerInput.value = '';
            wombatAnswerInput.focus();

            if (wombatCurrentMode === 'add') {
                // Year 3: sums up to about 30
                wombatNum1 = Math.floor(Math.random() * 15) + 1;
                wombatNum2 = Math.floor(Math.random() * 15) + 1;
                wombatCorrectAnswer = wombatNum1 + wombatNum2;
                wombatQuestionEl.innerText = `${wombatNum1} + ${wombatNum2} = ?`;
            } else if (wombatCurrentMode === 'sub') {
                // Answer positive, up to around 20‚Äì25
                wombatNum1 = Math.floor(Math.random() * 20) + 5;
                wombatNum2 = Math.floor(Math.random() * wombatNum1);
                wombatCorrectAnswer = wombatNum1 - wombatNum2;
                wombatQuestionEl.innerText = `${wombatNum1} ‚àí ${wombatNum2} = ?`;
            } else if (wombatCurrentMode === 'mul') {
                // Focus on 2, 3, 5, 10
                const factors = [2, 3, 5, 10];
                wombatNum1 = factors[Math.floor(Math.random() * factors.length)];
                wombatNum2 = Math.floor(Math.random() * 10) + 1;
                wombatCorrectAnswer = wombatNum1 * wombatNum2;
                wombatQuestionEl.innerText = `${wombatNum1} √ó ${wombatNum2} = ?`;
            }
        }

        function wombatCheckAnswer() {
            const playerAns = parseInt(wombatAnswerInput.value, 10);

            if (Number.isNaN(playerAns)) {
                wombatMessageEl.innerText = 'Pop in a number first üôÇ';
                wombatMessageEl.className = 'message wrong';
                return;
            }

            if (playerAns === wombatCorrectAnswer) {
                wombatMessageEl.innerText = 'Nice step! üåü';
                wombatMessageEl.className = 'message correct';
                wombatScore++;
                wombatScoreEl.innerText = wombatScore;
                wombatUpdatePosition();

                if (wombatScore >= wombatWinningScore) {
                    wombatQuestionEl.innerText = 'You reached Black Mountain! üéâ';
                    fireConfetti(2500);
                    setTimeout(() => {
                        wombatScore = 0;
                        wombatScoreEl.innerText = wombatScore;
                        wombatUpdatePosition();
                        wombatGenerateQuestion();
                        wombatMessageEl.innerText = '';
                    }, 2600);
                } else {
                    setTimeout(wombatGenerateQuestion, 800);
                }
            } else {
                wombatMessageEl.innerText = `Close! Try again. Hint: the answer is ${wombatCorrectAnswer}.`;
                wombatMessageEl.className = 'message wrong';
                // Show them the answer, then move on
                setTimeout(wombatGenerateQuestion, 1400);
            }
        }

        function wombatUpdatePosition() {
            // Move wombat from about 5% to 85% based on score (0‚ÄìwinningScore)
            const percentage = 5 + (wombatScore / wombatWinningScore) * 80;
            wombatEl.style.left = percentage + '%';
        }

        /* ---------- GAME 2: Times Table Jump ---------- */
        let timesCurrentTable = 'mix';
        let timesCorrectAnswer = null;
        let timesScore = 0;
        let timesStreak = 0;

        const timesQuestionEl = document.getElementById('times-question');
        const timesScoreEl = document.getElementById('times-score');
        const timesStreakEl = document.getElementById('times-streak');
        const timesMessageEl = document.getElementById('times-message');
        const timesButtons = [
            document.getElementById('times-opt-0'),
            document.getElementById('times-opt-1'),
            document.getElementById('times-opt-2')
        ];

        const timesTableButtons = {
            mix: document.getElementById('times-table-mix'),
            2: document.getElementById('times-table-2'),
            3: document.getElementById('times-table-3'),
            5: document.getElementById('times-table-5'),
            10: document.getElementById('times-table-10')
        };

        function startTimesGame() {
            timesScore = 0;
            timesStreak = 0;
            timesScoreEl.innerText = timesScore;
            timesStreakEl.innerText = timesStreak;
            timesMessageEl.innerText = '';
            setTimesTable('mix');
        }

        function setTimesTable(table) {
            timesCurrentTable = table;
            // Highlight active button
            Object.keys(timesTableButtons).forEach(key => {
                timesTableButtons[key].classList.toggle('active', String(key) === String(table));
            });
            timesScore = 0;
            timesStreak = 0;
            timesScoreEl.innerText = timesScore;
            timesStreakEl.innerText = timesStreak;
            timesMessageEl.innerText = '';
            generateTimesQuestion();
        }

        function generateTimesQuestion() {
            const tables = [2, 3, 5, 10];
            let a;
            if (timesCurrentTable === 'mix') {
                a = tables[Math.floor(Math.random() * tables.length)];
            } else {
                a = parseInt(timesCurrentTable, 10);
            }
            const b = Math.floor(Math.random() * 10) + 1; // 1‚Äì10

            timesCorrectAnswer = a * b;
            timesQuestionEl.innerText = `${a} √ó ${b} = ?`;
            timesMessageEl.innerText = '';

            // Build options: correct + 2 nearby numbers
            const options = [timesCorrectAnswer];
            while (options.length < 3) {
                const delta = Math.floor(Math.random() * 5) + 1; // 1‚Äì5
                const sign = Math.random() < 0.5 ? -1 : 1;
                const candidate = timesCorrectAnswer + sign * delta;
                if (candidate > 0 && !options.includes(candidate)) {
                    options.push(candidate);
                }
            }

            // Shuffle
            for (let i = options.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [options[i], options[j]] = [options[j], options[i]];
            }

            // Apply to buttons
            options.forEach((val, idx) => {
                const btn = timesButtons[idx];
                btn.innerText = val;
                btn.dataset.value = String(val);
            });
        }

        function timesCheckAnswer(btn) {
            const chosen = parseInt(btn.dataset.value, 10);
            if (chosen === timesCorrectAnswer) {
                timesScore++;
                timesStreak++;
                timesScoreEl.innerText = timesScore;
                timesStreakEl.innerText = timesStreak;
                timesMessageEl.innerText = 'Boom! Nailed it. üí•';
                timesMessageEl.className = 'message correct';

                if (timesScore % 10 === 0) {
                    fireConfetti();
                }

                setTimeout(generateTimesQuestion, 800);
            } else {
                timesStreak = 0;
                timesStreakEl.innerText = timesStreak;
                timesMessageEl.innerText = `Not quite. The answer was ${timesCorrectAnswer}.`;
                timesMessageEl.className = 'message wrong';
                setTimeout(generateTimesQuestion, 1300);
            }
        }

        /* ---------- GAME 3: Place Value Patrol ---------- */
        let placeCorrectDigit = null;
        let placeScore = 0;

        const placeNumberEl = document.getElementById('place-number');
        const placeQuestionEl = document.getElementById('place-question');
        const placeScoreEl = document.getElementById('place-score');
        const placeMessageEl = document.getElementById('place-message');
        const placeButtons = [
            document.getElementById('place-opt-0'),
            document.getElementById('place-opt-1'),
            document.getElementById('place-opt-2')
        ];

        function startPlaceGame() {
            placeScore = 0;
            placeScoreEl.innerText = placeScore;
            placeMessageEl.innerText = '';
            generatePlaceQuestion();
        }

        function generatePlaceQuestion() {
            placeMessageEl.innerText = '';
            placeMessageEl.className = 'message';

            // Random 3-digit number, leading digit 1‚Äì9
            const hundreds = Math.floor(Math.random() * 9) + 1;
            const tens = Math.floor(Math.random() * 10);
            const ones = Math.floor(Math.random() * 10);
            const number = hundreds * 100 + tens * 10 + ones;
            placeNumberEl.innerText = number;

            const placeTypes = [
                { key: 'hundreds', label: 'hundreds digit', value: hundreds },
                { key: 'tens', label: 'tens digit', value: tens },
                { key: 'ones', label: 'ones digit', value: ones }
            ];
            const chosen = placeTypes[Math.floor(Math.random() * placeTypes.length)];
            placeCorrectDigit = chosen.value;
            placeQuestionEl.innerText = `What is the ${chosen.label}?`;

            const options = [placeCorrectDigit];
            while (options.length < 3) {
                const candidate = Math.floor(Math.random() * 10); // 0‚Äì9
                if (!options.includes(candidate)) {
                    options.push(candidate);
                }
            }

            // Shuffle
            for (let i = options.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [options[i], options[j]] = [options[j], options[i]];
            }

            options.forEach((val, idx) => {
                const btn = placeButtons[idx];
                btn.innerText = val;
                btn.dataset.value = String(val);
            });
        }

        function placeCheckAnswer(btn) {
            const chosen = parseInt(btn.dataset.value, 10);
            if (chosen === placeCorrectDigit) {
                placeScore++;
                placeScoreEl.innerText = placeScore;
                placeMessageEl.innerText = 'Spot on! ü¶ú';
                placeMessageEl.className = 'message correct';

                if (placeScore % 10 === 0) {
                    fireConfetti();
                }

                setTimeout(generatePlaceQuestion, 900);
            } else {
                placeMessageEl.innerText = `Nice try. The correct digit was ${placeCorrectDigit}.`;
                placeMessageEl.className = 'message wrong';
                setTimeout(generatePlaceQuestion, 1300);
            }
        }
    </script>
</body>
</html>
